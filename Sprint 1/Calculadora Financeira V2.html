<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Financeiro</title>
</head>

<body>
    <div>
        <h1>Calcule sua economia utilizando nossa solução</h1>
        <div>
            Selecione seu tipo de produção:<br>
            <select name="" id="select_producao">
                <option value="selecione" selected disabled>Selecione...</option>
                <option>Lavoura</option>
                <option>Pastagem</option>
                <option>Perene</option>
            </select><span id="aviso" style="display:none; color:red;"> Por favor, selecione seu tipo de produção!</span><br><br>
            Insira a área total da sua propriedade (em hectares):<br>
            <input type="number" name="" min="1" id="input_areaTotal"><span id="aviso2" style="display:none; color:red;"> Por favor, insira sua área total de propriedade!</span><br><br>
            Insira seu custo de investimento médio por safra (por hectare):<br>
            <input type="number" min="0" id="input_investimento"><span id="aviso3" style="display:none; color:red;"> Por favor, insira seu custo de investimento!</span><br><br>
            Insira seu lucro líquido mensal (por hectare):<br>
            <input type="number" name="" id="input_lucroMensal"><span id="aviso4" style="display:none; color:red;"> Por favor, insira seu lucro líquido mensal!</span><br><br>
            <input type="checkbox" name="" id="input_TecPrevent"> <i>Já utiliza técnica de prevenção</i><br>
            <input type="checkbox" name="" id="input_VegNativa"> <i>Vegetacão nativa presente</i><br>
            <input type="checkbox" name="" id="input_TerraInd"> <i>Proximidade com terras indígenas</i><br><br>
        </div>
        <div>
            <button onclick="calcular_economia()">Calcule sua economia!</button><BR>
        </div>
        <div id="div_mensagem1"></div>

    </div>
    <div id="div_msgTerraIndigena"></div>
    <div id="div_mensagem2"></div>
    <div id="div_mensagem3"></div>
    <div id="div_mensagem4"></div>

</body>
<script>
    //Código HTML e JS desenvolvidos por Aurora Carvalho.
    //Variáveis Globais

    //Valores das multas
    var multasAgro = 3000
    var multasNativa = 10000

    //Custos de recuperação de solo total por hectare
    var custo_lavoura = 800
    var custo_pastagem = 4400
    var custo_perene = 6000
    var custo_nativa = 17000

    //Custos de prejuizo
      var prejuizoNativa = 0

    //Calculos de prejuizo Meio de safra
    var prejuizoProdMeio = 0
    var prejuizoBrutoTotalMeio = 0
    var prejuizoEsperadoSSensorMeio = 0
    var prejuizoEsperadoCSensorMeio = 0

    //Calculos de prejuizo Pos safra
    var prejuizoProdPos = 0
    var prejuizoBrutoTotalPos = 0
    var prejuizoEsperadoSSensorPos = 0
    var prejuizoEsperadoCSensorPos = 0

    //Calculo de economia
    var economiaTotal = 0

    //Meses de recuperação (consequentemente sem produção)
    var mesesRecuperacao = 0

    function calcular_economia() {


        //Validação de entradas: o preenchimento de todos os campos é obrigatório, senão uma mensagem de erro é exibida e o programa retorna ao início.
        var erro = false

          if (select_producao.value === "selecione") {
            aviso.style.display = "inline"
            erro = true
        } else {
            aviso.style.display = "none"
        }

        if (input_areaTotal.value === "") {
              aviso2.style.display = "inline"
            erro = true
        } else {
            aviso2.style.display = "none"
        }
        if (input_investimento.value === "") {
              aviso3.style.display = "inline"
            erro = true
        } else {
            aviso3.style.display = "none"
        }

        if (input_lucroMensal.value === "") {
              aviso4.style.display = "inline"
            erro = true;
        } else {
            aviso4.style.display = "none"
        }

        if (erro) {
            return
        }
      

        var tipoProd = select_producao.value.toLowerCase()
        var areaTotal = Number(input_areaTotal.value)
        var investimento = Number(input_investimento.value)
        var lucroMensal = Number(input_lucroMensal.value)
        var tecPrevent = input_TecPrevent.checked
        var vegNativa = input_VegNativa.checked
        var TerraInd = input_TerraInd.checked

        
        //Excluindo a possibilidade da calculadora considerar uma economia em caso de incêndio caso o produtor insira lucro negativo (prejuízo)
        if (lucroMensal < 0) {
            lucroMensal = 0
        }

        // Definição de probabilidade de incendio de acordo com o tam do produtor
        if (areaTotal <= 200) {
            var probIncendioBase = 0.15

        } else {
            probIncendioBase = 0.2
        }

        // Se usar tecnicas de prevenção, o risco reduz em 30%
        if (tecPrevent) {
            var probIncendioAjustada = probIncendioBase - (probIncendioBase * 0.3)
        } else {
            probIncendioAjustada = probIncendioBase
        }

        //Definição de área nativa x área produtiva
        var areaNativa = 0;
        var areaProd = areaTotal

        if (vegNativa) {
            areaNativa = areaTotal * 0.2
            areaProd = areaTotal - areaNativa
        }

        //Definição dos prejuizos baseados no tipo de produção e se a checkbox "Nativa" foi marcada
        var custoRecuperacao = 0

        if (tipoProd == "lavoura") {
            custoRecuperacao = custo_lavoura
            mesesRecuperacao = 4
        }
        if (tipoProd == "pastagem") {
            custoRecuperacao = custo_pastagem
            mesesRecuperacao = 6
        }
        if (tipoProd == "perene") {
            custoRecuperacao = custo_perene
            mesesRecuperacao = 8
        }

        var investMeioSafra = investimento * 0.5
        var investPosSafra = investimento * 0.1


        prejuizoProd_meioSafra = (lucroMensal * mesesRecuperacao) + custoRecuperacao + multasAgro + investMeioSafra
        prejuizoProd_posSafra = (lucroMensal * mesesRecuperacao) + custoRecuperacao + multasAgro + investPosSafra



        if (vegNativa) {
            //O valor de lucro da vegetação nativa é 0 pois não há cultivo ou criação
            prejuizoNativa = custo_nativa + multasNativa
        } else { prejuizoNativa = 0 }

        //Prejuízo bruto total (multiplicando pela quantidade de hectares)
        prejuizoBrutoTotalMeio = (prejuizoProd_meioSafra * areaProd) + (prejuizoNativa * areaNativa)
        prejuizoBrutoTotalPos = (prejuizoProd_posSafra * areaProd) + (prejuizoNativa * areaNativa)

        //Prejuízo esperado sem o uso do sensor
        prejuizoEsperadoSSensorMeio = prejuizoBrutoTotalMeio * probIncendioAjustada
        prejuizoEsperadoSSensorPos = prejuizoBrutoTotalPos * probIncendioAjustada

        //Prejuízo esperado com o uso do sensor 
        // 50% de economia é um valor conservador baseado em literaturas técnicas de dispositivos tecnológicos de prevenção
        prejuizoEsperadoCSensorMeio = prejuizoEsperadoSSensorMeio * 0.5
        prejuizoEsperadoCSensorPos = prejuizoEsperadoSSensorPos * 0.5

        //Economia total com o uso do sensor 
        economiaTotalMeio = prejuizoEsperadoSSensorMeio - prejuizoEsperadoCSensorMeio
        economiaTotalPos = prejuizoEsperadoSSensorPos - prejuizoEsperadoCSensorPos


        div_mensagem1.innerHTML = `Se a sua área de ${areaTotal} hectares for atingida por um incêndio no meio da safra, o prejuízo esperado (considerando multas e custos de recuperação do solo) chega a ${prejuizoEsperadoSSensorMeio.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })} baseado numa probabilidade de incêndio em ${probIncendioAjustada*100}%** da área.<br>
        Nossa solução garante redução de 50%* do valor do prejuízo esperado, então com o nosso sensor IoT para monitoramento da umidade do solo, esse valor cai para ${prejuizoEsperadoCSensorMeio.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}.<br>
        
        Caso sua área de ${areaTotal} hectares for atingida por um incêndio depois da safra, o prejuízo esperado (considerando multas e custos de recuperação do solo) chega a ${prejuizoEsperadoSSensorPos.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })} baseado numa probabilidade de incêndio em ${probIncendioAjustada*100}%** da área.<br>
        Nesse caso, com nossa solução, esse valor cai para ${prejuizoEsperadoCSensorPos.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}!<br>

        Sem prevenção, o fogo consome sua produção e seu bolso. Com prevenção, você transforma um risco catastrófico em um impacto controlável.<br>
        `
        div_mensagem2.innerHTML = `<h6>*Cálculos utilizam valores conservadores baseados em literatura técnica.</h6>`
        div_mensagem3.innerHTML = `<h6>**A calculadora não contempla casos de incêndio em 100% da área do produtor.</h6>`
        div_mensagem4.innerHTML = `<h6>***Em caso do produtor inserir um lucro negativo (prejuízo), o valor do lucro será considerado 0 para não indicar economia em caso de incêndio.</h6>`


        if (TerraInd) {
            div_msgTerraIndigena.innerHTML = "<i>Em áreas com presença de terras indígenas, as penalidades podem ser significativamente maiores que as estimadas pela calculadora, incluindo custos legais adicionais não contemplados neste modelo.</i>"

        }


    }

</script>

</html>